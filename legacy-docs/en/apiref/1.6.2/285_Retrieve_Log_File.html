<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <!-- default template -->
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>285_Retrieve_Log_File</title>
  <style type="text/css">
div.sourceLine, a.sourceLine { display: inline-block; min-height: 1.25em; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; }
@media print {
code.sourceCode { white-space: pre-wrap; }
div.sourceLine, a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource div.sourceLine, .numberSource a.sourceLine
  { position: relative; }
pre.numberSource div.sourceLine::before, .numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em; }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; color: #aaaaaa;  padding-left: 4px; }
@media screen {
a.sourceLine::before { text-decoration: underline; color: initial; }
}
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.bn { color: #40a070; } /* BaseN */
code span.fl { color: #40a070; } /* Float */
code span.ch { color: #4070a0; } /* Char */
code span.st { color: #4070a0; } /* String */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.ot { color: #007020; } /* Other */
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.fu { color: #06287e; } /* Function */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code span.cn { color: #880000; } /* Constant */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.ss { color: #bb6688; } /* SpecialString */
code span.im { } /* Import */
code span.va { color: #19177c; } /* Variable */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.op { color: #666666; } /* Operator */
code span.bu { } /* BuiltIn */
code span.ex { } /* Extension */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.at { color: #7d9029; } /* Attribute */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
  <script type="text/javascript">
      var path = location.pathname.split('/');
      var pathRoot = [ path[0], path[1], '' ].join('/');
      var pathLang = [ path[0], path[1], path[2] , ''].join('/');

      document.write('<link rel="stylesheet" href="' + pathRoot + 'personium.css" type="text/css" />');
      document.write('<link rel="stylesheet" href="' + pathLang + 'locale.css" type="text/css" />');
      var ps = document.createElement('script');
      ps.src = pathRoot + 'personium_docs.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(ps, s);

  </script>
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
  
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
  <header>
    <nav>
    <div id="logo"><a href="/">Personium</a></div>
    <ul>
      <li class="submenu">
        <a href="" >Introduction</a>
        <ul>
            <li><a href="javascript:p.toPage('/overview/001_Introduction.html');">What's Personium?</a></li>
            <li><a href="javascript:p.toPage('/user_guide/001_Personium_Architecture.html');">Architecture</a></li>
            <li><a href="javascript:p.toPage('/user_guide/008_Glossary.html');">Glossary</a></li>
        </ul>
      </li>
      <li class="submenu">
        <a href="" >User Guide</a>
        <ul>
            <li><a href="javascript:p.toPage('/app-developer/');">for App Developer</a></li>
            <li><a href="javascript:p.toPage('/cell-client-developer/');">for Cell App Developer</a></li>
            <li><a href="javascript:p.toPage('/unit-administrator/');">for Unit Administrator</a></li>
            <li><a href="javascript:p.toPage('/server-operator/');">for Server Software Operator</a></li>
            <li><a href="javascript:p.toPage('/document-writer/');">for Documentation Contributor</a></li>
            <li><a href="javascript:p.toPage('/plugin-developer/');">for Server Plugin Developer</a></li>
            <li><a href="javascript:p.toPage('/software-developer/');">for Server Developer</a></li>
        </ul>
      </li>
      <li class="submenu">
        <a href="" >API Reference</a>
        <ul>
            <li><a href="#" onclick="p.toApiRef(this);return false;">current</a></li>
            <li><a href="#" onclick="p.toApiRef(this);return false;">1.6.2</a></li>
            <li><a href="#" onclick="p.toApiRef('1.6.0');return false;">1.6.0-1.6.1</a></li>
            <li><a href="#" onclick="p.toApiRef(this);return false;">1.5.8</a></li>
            <li><a href="#" onclick="p.toApiRef(this);return false;">1.5.7</a></li>
            <li><a href="#" onclick="p.toApiRef(this);return false;">1.5.6</a></li>
            <li><a href="#" onclick="p.toApiRef(this);return false;">1.5.5</a></li>
            <li><a href="javascript:p.toApiRef('1.5.2');">1.5.2-1.5.4</a></li>
            <li><a href="javascript:p.toPage('/user_guide/990_Old_Version_API_Ref.html');">older versions</a></li>
        </ul>
      </li>
      <li class="submenu">
        <a href="" >Languages</a>
        <ul>
            <li><a href="javascript:p.setLang('en');">English</a></li>
            <li><a href="javascript:p.setLang('ja');">Japanese</a></li>
        </ul>
      </li>
    </ul>
    </nav>
  </header>

<div id="container">
<h1>Log File Acquire</h1>
<h2>Overview</h2>
<p>acquire event log<br />
If you exceed the maximum number of generations to hold rotate when the log file, the log file of the oldest is deleted.</p>
<h3>Required Privileges</h3>
<p>log-read</p>
<h3>Restrictions</h3>
<ul>
<li>Maximum depth of the hierarchy of the collection 50</li>
<li>The maximum value of the child number of elements in each collection under 10,000
<ul>
<li>The collection immediately below the Box is regarded as the first level, and the collection is counted as the second level, the third level, Files to be created under the collection are not counted as hierarchies</li>
</ul></li>
<li>Log output of the internal event is not supported</li>
<li>Log output configuration is not supported. Log output configuration reference is not supported.</li>
<li>Set the log file name as &quot;default.log &quot;</li>
<li>Rotate will be according to following default settings
<ul>
<li>Set rotate size: 50MB</li>
</ul></li>
<li>Configure the log output level to &quot;info&quot; (output for all INFO, WARN, ERROR).</li>
<li>The file name when rotated is default.log. {Timestamp}. {Timestamp} is numbered by the time when it was rotated.</li>
</ul>
<table style="width:22%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Action</th>
<th style="text-align: left;">Archived log file</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">First Rotation</td>
<td style="text-align: left;">archive/<br>default.log.1402910774659</td>
<td style="text-align: left;"><br>Newly rotated file</td>
<td style="text-align: left;"><br>2014-06-16 18:26:14 +0900</td>
</tr>
<tr class="even">
<td style="text-align: left;">2nd Rotation</td>
<td style="text-align: left;">archive/<br>default.log.1402910774659<br>default.log.1403910784659</td>
<td style="text-align: left;"><br>the preceding roteted file<br>Newly rotated file</td>
<td style="text-align: left;"><br>2014-06-16 18:26:14 +0900<br>2014-06-28 08:13:04 +0900</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3rd Rotation</td>
<td style="text-align: left;">archive/<br>default.log.1402910774659<br>default.log.1403910784659<br>default.log.1403910784659</td>
<td style="text-align: left;"><br>the file before preceding file<br>the preceding roteted file<br>Newly rotated file</td>
<td style="text-align: left;"><br>2014-06-16 18:26:14 +0900<br>2014-06-28 08:13:04 +0900<br>2014-07-09 21:59:44 +0900</td>
</tr>
</tbody>
</table>
<h2>Request</h2>
<h3>Request URL</h3>
<h4>Recent log file</h4>
<pre><code>/{CellName}/__log/current/{LogName}</code></pre>
<h4>Log file that is rotated</h4>
<pre><code>/{CellName}/__log/archive/{LogName}</code></pre>
<p>*{LogName} specifies the file name returned by the log file information acquisition API.</p>
<h3>Request Method</h3>
<p>GET</p>
<h3>Request Query</h3>
<table style="width:28%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Query Name</th>
<th style="text-align: left;">Overview</th>
<th style="text-align: left;">Effective Value</th>
<th style="text-align: left;">Required</th>
<th style="text-align: left;">Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">p_cookie_peer</td>
<td style="text-align: left;">Cookie Authentication Value</td>
<td style="text-align: left;">The cookie authentication value returned from the server during authentication</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Valid only if no Authorization header specified<br>Specify this when cookie authentication information is to be used</td>
</tr>
</tbody>
</table>
<h3>Request Header</h3>
<h4>Common Request Header</h4>
<table style="width:28%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Header Name</th>
<th style="text-align: left;">Overview</th>
<th style="text-align: left;">Effective Value</th>
<th style="text-align: left;">Required</th>
<th style="text-align: left;">Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">X-HTTP-Method-Override</td>
<td style="text-align: left;">Method override function</td>
<td style="text-align: left;">User-defined</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Specifying this value in a request with the POST method indicates that the specified value is used as the method</td>
</tr>
<tr class="even">
<td style="text-align: left;">X-Override</td>
<td style="text-align: left;">Header override function</td>
<td style="text-align: left;">${OverwrittenHeaderName}:${Value}</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">The normal HTTP header value is overwritten. Specify multiple X-Override headers for the overwriting of multiple headers</td>
</tr>
<tr class="odd">
<td style="text-align: left;">X-Personium-RequestKey</td>
<td style="text-align: left;">RequestKey field value output in the event log</td>
<td style="text-align: left;">Single-byte alphanumeric characters, hyphens (&quot;-&quot;), and underscores (&quot;_&quot;)<br>Maximum of 128 characters</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">PCS-${UNIXtime} by default</td>
</tr>
<tr class="even">
<td style="text-align: left;">Authorization</td>
<td style="text-align: left;">Specifies authentication information in the OAuth 2.0 format</td>
<td style="text-align: left;">Bearer {AccessToken}</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">* Authentication tokens are the tokens acquired using the Authentication Token Acquisition API</td>
</tr>
</tbody>
</table>
<h3>Request Body</h3>
<p>None</p>
<h2>Response</h2>
<h3>Response Code</h3>
<p>200</p>
<h3>Response Header</h3>
<table style="width:17%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Header Name</th>
<th style="text-align: left;">Overview</th>
<th style="text-align: left;">Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Content-Type</td>
<td style="text-align: left;">MimeType depending on Resource</td>
<td style="text-align: left;">&quot;text/csv&quot; or &quot;application/zip&quot;</td>
</tr>
</tbody>
</table>
<h3>Response Body</h3>
<p>If there is no log at current log acquisition time, return an empty response body.<br />
There is a possibility that the rotate size is about 5MB larger than it configured<br />
Output form is following</p>
<pre><code>{dateTime},[{level}],{RequestKey},{external},{schema},{subject},{type},{object},{info}</code></pre>
<table style="width:17%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Item Name</th>
<th style="text-align: left;">Overview</th>
<th style="text-align: left;">Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">dateTime</td>
<td style="text-align: left;">Log write date and time (ISO8601 UTC format)</td>
<td style="text-align: left;">YYYY-MM-DDTHH:MM:SS.sssZ</td>
</tr>
<tr class="even">
<td style="text-align: left;">level</td>
<td style="text-align: left;">log level INFO,WARN,ERROR</td>
<td style="text-align: left;">String</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RequestKey</td>
<td style="text-align: left;">Value specified on X-Dc-RequestKey header<br>when the X-Dc-RequestKey header is not specified, PCS-$ {UNIX time}</td>
<td style="text-align: left;">String</td>
</tr>
<tr class="even">
<td style="text-align: left;">external</td>
<td style="text-align: left;">External events:true<br>Internal events:false</td>
<td style="text-align: left;">String</td>
</tr>
<tr class="odd">
<td style="text-align: left;">schema</td>
<td style="text-align: left;">Schema of box of accepted URL</td>
<td style="text-align: left;">URL format</td>
</tr>
<tr class="even">
<td style="text-align: left;">subject</td>
<td style="text-align: left;">Principal events</td>
<td style="text-align: left;">URL format</td>
</tr>
<tr class="odd">
<td style="text-align: left;">type</td>
<td style="text-align: left;">External events: Type defined in the event reception<br>Internal events: Type defined for each event</td>
<td style="text-align: left;">String</td>
</tr>
<tr class="even">
<td style="text-align: left;">object</td>
<td style="text-align: left;">External events: Object defined in the event reception<br>Internal events:Requested resource path</td>
<td style="text-align: left;">String</td>
</tr>
<tr class="odd">
<td style="text-align: left;">info</td>
<td style="text-align: left;">External events: Info defined in the event reception<br>Internal events:HTTP status code</td>
<td style="text-align: left;">String</td>
</tr>
</tbody>
</table>
<h3>Error Messages</h3>
<p>Refer to <a href="004_Error_Messages.html">Error Message List</a></p>
<h3>Response Sample</h3>
<p>External Events</p>
<pre><code>2013-02-04T00:50:12.761Z,[INFO ],Req_animal-access_1001,client,https://{UnitFQDN}/{CellName}/,
https://{UnitFQDN}/servicemanager/#admin,authSchema,/{CellName}/{BoxName}/service_name/token_keeper,
[XXXX2033] Success schema authorization. cellUrl=https://{UnitFQDN}/keeper-d4a57bb26eae481486b07d06487051d1/</code></pre>
<p>Internal Event</p>
<pre><code>2013-04-18T14:52:39.778Z,[INFO ],&quot;PCS-1364350331902&quot;,&quot;false&quot;,&quot;https://{UnitFQDN}/appCell/&quot;,
&quot;https://{UnitFQDN}/appCell/#staff&quot;,&quot;cellctl.Role.list&quot;,&quot;https://{UnitFQDN}//homeClinic/__ctl/Role&quot;,&quot;200&quot;</code></pre>
<h2>cURL Command</h2>
<pre class="sourceCode sh" id="cb6"><code class="sourceCode bash"><div class="sourceLine" id="cb6-1" data-line-number="1"><span class="ex">curl</span> <span class="st">&quot;https://{UnitFQDN}/{CellName}/__log/current/default.log&quot;</span> -X GET -i -H \</div>
<div class="sourceLine" id="cb6-2" data-line-number="2"><span class="st">&#39;Authorization: Bearer {AccessToken}&#39;</span> -H <span class="st">&#39;Accept: application/json&#39;</span></div></code></pre>
</div>
  <footer><nav>The Personium project is provided under the Apache 2.0 license. </nav></footer>
</body>
</html>
