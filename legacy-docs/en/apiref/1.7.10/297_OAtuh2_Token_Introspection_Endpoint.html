<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <!-- default template -->
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <link rel="icon" href="/images/favicon.ico" type="image/x-icon"/>
  <title>297_OAtuh2_Token_Introspection_Endpoint</title>
  <style type="text/css">
div.sourceLine, a.sourceLine { display: inline-block; min-height: 1.25em; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; }
@media print {
code.sourceCode { white-space: pre-wrap; }
div.sourceLine, a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource div.sourceLine, .numberSource a.sourceLine
  { position: relative; }
pre.numberSource div.sourceLine::before, .numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em; }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; color: #aaaaaa;  padding-left: 4px; }
@media screen {
a.sourceLine::before { text-decoration: underline; color: initial; }
}
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.bn { color: #40a070; } /* BaseN */
code span.fl { color: #40a070; } /* Float */
code span.ch { color: #4070a0; } /* Char */
code span.st { color: #4070a0; } /* String */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.ot { color: #007020; } /* Other */
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.fu { color: #06287e; } /* Function */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code span.cn { color: #880000; } /* Constant */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.ss { color: #bb6688; } /* SpecialString */
code span.im { } /* Import */
code span.va { color: #19177c; } /* Variable */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.op { color: #666666; } /* Operator */
code span.bu { } /* BuiltIn */
code span.ex { } /* Extension */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.at { color: #7d9029; } /* Attribute */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
  <script type="text/javascript">
      var path = location.pathname.split('/');
      var pathRoot = [ path[0], path[1], '' ].join('/');
      var pathLang = [ path[0], path[1], path[2] , ''].join('/');

      //load style sheets
      document.write('<link rel="stylesheet" href="' + pathRoot + 'personium.css" type="text/css" />');
      document.write('<link rel="stylesheet" href="' + pathLang + 'locale.css" type="text/css" />');
      //load personium_docs.js
      var ps = document.createElement('script');
      ps.src = pathRoot + 'personium_docs.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(ps, s);
    
      //load apiref_versions.js
      ps2 = document.createElement('script');
      ps2.src = pathRoot + 'apiref_versions.js';
      s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(ps2, s);

  </script>
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
  
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
  <header>
    <nav>
    <div id="logo"><a href="/"><img src="/images/logo-quantify-dark.png" /></a></div>
    <ul>
      <li class="submenu">
        <a href="" >Introduction</a>
        <ul>
            <li><a href="javascript:p.toPage('/overview/001_Introduction.html');">What's Personium?</a></li>
            <li><a href="javascript:p.toPage('/user_guide/001_Personium_Architecture.html');">Architecture</a></li>
            <li><a href="javascript:p.toPage('/user_guide/008_Glossary.html');">Glossary</a></li>
        </ul>
      </li>
      <li class="submenu">
        <a href="" >User Guide</a>
        <ul>
            <li><a href="javascript:p.toPage('/app-developer/');">for App Developer</a></li>
            <li><a href="javascript:p.toPage('/cell-client-developer/');">for Cell App Developer</a></li>
            <li><a href="javascript:p.toPage('/unit-administrator/');">for Unit Administrator</a></li>
            <li><a href="javascript:p.toPage('/server-operator/');">for Server Software Operator</a></li>
            <li><a href="javascript:p.toPage('/document-writer/');">for Documentation Contributor</a></li>
            <li><a href="javascript:p.toPage('/plugin-developer/');">for Server Plugin Developer</a></li>
            <li><a href="javascript:p.toPage('/software-developer/');">for Server Developer</a></li>
        </ul>
      </li>
      <li class="submenu">
        <a href="" >API Reference</a>
        <ul id="api-ref-list">
            <li><a href="javascript:p.toPage('/user_guide/990_Old_Version_API_Ref.html');">older versions</a></li>
        </ul>
      </li>
      <li class="submenu">
        <a href="" >Languages</a>
        <ul>
            <li><a href="javascript:p.setLang('en');">English</a></li>
            <li><a href="javascript:p.setLang('ja');">Japanese</a></li>
        </ul>
      </li>
    </ul>
    </nav>
  </header>

<div id="container">
<h1>OAuth 2.0 Token Introspection Endpoint</h1>
<h2>Overview</h2>
<p>It is the API endpoint that acquires the contents of the token. Implements RFC 7662.</p>
<p>It returns results only if the token Issuer or Audience is equal to CellURL.</p>
<h3>Required Privileges</h3>
<p>None</p>
<h3>Restrictions</h3>
<ul>
<li>Accept in the request header is ignored</li>
<li>We treat all Content-Type of the request header as application/x-www-form-urlencoded</li>
<li>The response header Content-Type supports only application/json, and the response body is JSON format</li>
</ul>
<h2>Request</h2>
<h3>Request URL</h3>
<pre><code>{CellURL}/__introspect</code></pre>
<h3>Request Method</h3>
<p>POST</p>
<h3>Request Header</h3>
<table style="width:28%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Header Name</th>
<th style="text-align: left;">Overview</th>
<th style="text-align: left;">Effective Value</th>
<th style="text-align: left;">Required</th>
<th style="text-align: left;">Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Authorization</td>
<td style="text-align: left;">Specify authentication information in OAuth 2.0 format</td>
<td style="text-align: left;">Bearer {Token}<br>Basic {Base64String}</td>
<td style="text-align: left;">○</td>
<td style="text-align: left;">In the case of Bearer, the authentication token is the access token acquired by the authentication token acquisition API. It is possible to acquire token information only when unit token or unit user token or Schema of token matches Schema of token specified by request body.<br>For Basic, user name and password are those set for Introspection by Unit setting, or CellURL and token are specified. In the case of CellURL and token, token information can be obtained only when client authentication is OK and CellURL is token that matches Schema</td>
</tr>
<tr class="even">
<td style="text-align: left;">Content-Type</td>
<td style="text-align: left;">Specify the format of the request body</td>
<td style="text-align: left;">application/x-www-form-urlencoded</td>
<td style="text-align: left;">×</td>
<td style="text-align: left;">When omitted, treat it as [application/x-www-form-urlencoded]</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Accept</td>
<td style="text-align: left;">Specify the format of the response body</td>
<td style="text-align: left;">application/json</td>
<td style="text-align: left;">×</td>
<td style="text-align: left;">When omitted, treat it as [application/json]</td>
</tr>
</tbody>
</table>
<h3>Request Body</h3>
<table style="width:28%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Item Name</th>
<th style="text-align: left;">Overview</th>
<th style="text-align: left;">Format</th>
<th style="text-align: left;">Required</th>
<th style="text-align: left;">Effective Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">token</td>
<td style="text-align: left;">Token</td>
<td style="text-align: left;">String</td>
<td style="text-align: left;">○</td>
<td style="text-align: left;">Access Token or Refresh Token Acquired with Authentication Token Acquisition API</td>
</tr>
</tbody>
</table>
<h3>Request Sample</h3>
<pre><code>token=AA~(snip)
</code></pre>
<h2>Response</h2>
<h3>Response Code</h3>
<p>200</p>
<h3>Response Header</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Item Name</th>
<th style="text-align: left;">Overview</th>
<th style="text-align: left;">Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Content-Type</td>
<td style="text-align: left;">application/json</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3>レスポンスボディ</h3>
<table style="width:22%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Item Name</th>
<th style="text-align: left;">Overview</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">active</td>
<td style="text-align: left;">Whether the token is valid</td>
<td style="text-align: left;">boolean</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">client_id</td>
<td style="text-align: left;">ClientID</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">In personium the schema of the token</td>
</tr>
<tr class="odd">
<td style="text-align: left;">exp</td>
<td style="text-align: left;">expiration date</td>
<td style="text-align: left;">integer</td>
<td style="text-align: left;">January 1 1970 Number of seconds since UTC</td>
</tr>
<tr class="even">
<td style="text-align: left;">iat</td>
<td style="text-align: left;">Issue time</td>
<td style="text-align: left;">integer</td>
<td style="text-align: left;">January 1 1970 Number of seconds since UTC</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sub</td>
<td style="text-align: left;">Main token</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">In personium the subject of the token</td>
</tr>
<tr class="even">
<td style="text-align: left;">aud</td>
<td style="text-align: left;">Token Audience</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">In personium the target in the transcell token</td>
</tr>
<tr class="odd">
<td style="text-align: left;">iss</td>
<td style="text-align: left;">Issuer of the token</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">The URL of the cell that issued the token</td>
</tr>
<tr class="even">
<td style="text-align: left;">p_roles</td>
<td style="text-align: left;">List of roles contained in the token</td>
<td style="text-align: left;">list of string</td>
<td style="text-align: left;">personium proprietary specification</td>
</tr>
</tbody>
</table>
<h3>Response Sample</h3>
<p>For valid tokens</p>
<pre class="sourceCode json" id="cb3"><code class="sourceCode json"><div class="sourceLine" id="cb3-1" data-line-number="1"><span class="fu">{</span></div>
<div class="sourceLine" id="cb3-2" data-line-number="2">  <span class="dt">&quot;active&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span></div>
<div class="sourceLine" id="cb3-3" data-line-number="3">  <span class="dt">&quot;exp&quot;</span><span class="fu">:</span> <span class="dv">1544059820</span><span class="fu">,</span></div>
<div class="sourceLine" id="cb3-4" data-line-number="4">  <span class="dt">&quot;iat&quot;</span><span class="fu">:</span> <span class="dv">1543973420</span><span class="fu">,</span></div>
<div class="sourceLine" id="cb3-5" data-line-number="5">  <span class="dt">&quot;sub&quot;</span><span class="fu">:</span> <span class="st">&quot;https://cell1.unit1.example/#account&quot;</span><span class="fu">,</span></div>
<div class="sourceLine" id="cb3-6" data-line-number="6">  <span class="dt">&quot;aud&quot;</span><span class="fu">:</span> <span class="st">&quot;https://cell2.unit1.example/&quot;</span><span class="fu">,</span></div>
<div class="sourceLine" id="cb3-7" data-line-number="7">  <span class="dt">&quot;iss&quot;</span><span class="fu">:</span> <span class="st">&quot;https://cell1.unit1.example/&quot;</span><span class="fu">,</span></div>
<div class="sourceLine" id="cb3-8" data-line-number="8">  <span class="dt">&quot;p_roles&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;https://cell1.unit1.example/__role/__/role1&quot;</span><span class="ot">,</span><span class="st">&quot;https://cell1.unit1.example/__role/__/role2&quot;</span><span class="ot">]</span></div>
<div class="sourceLine" id="cb3-9" data-line-number="9"><span class="fu">}</span></div></code></pre>
<p>For invalid token</p>
<pre class="sourceCode json" id="cb4"><code class="sourceCode json"><div class="sourceLine" id="cb4-1" data-line-number="1"><span class="fu">{</span></div>
<div class="sourceLine" id="cb4-2" data-line-number="2">  <span class="dt">&quot;active&quot;</span><span class="fu">:</span> <span class="kw">false</span><span class="fu">,</span></div>
<div class="sourceLine" id="cb4-3" data-line-number="3"><span class="fu">}</span></div></code></pre>
<h3>Error Messages</h3>
<p>Refer to <a href="004_Error_Messages.html">Error Message List</a></p>
<h2>cURL Command</h2>
<pre class="sourceCode sh" id="cb5"><code class="sourceCode bash"><div class="sourceLine" id="cb5-1" data-line-number="1"><span class="ex">curl</span> <span class="st">&quot;https://cell1.unit1.example/__introspect&quot;</span> -X POST -i \</div>
<div class="sourceLine" id="cb5-2" data-line-number="2">-H <span class="st">&#39;Authorization:Basic username:password&#39;</span> \</div>
<div class="sourceLine" id="cb5-3" data-line-number="3">-H <span class="st">&#39;Content-Type:application/x-www-form-urlencoded&#39;</span> \</div>
<div class="sourceLine" id="cb5-4" data-line-number="4">-H <span class="st">&#39;Accept:application/json&#39;</span> \</div>
<div class="sourceLine" id="cb5-5" data-line-number="5">-d <span class="st">&#39;token=RA~(snip)&#39;</span></div></code></pre>
</div>
  <footer><nav>The Personium project is provided under the Apache 2.0 license. </nav></footer>
</body>
</html>
