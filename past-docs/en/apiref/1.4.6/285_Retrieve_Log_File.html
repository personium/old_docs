<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
  <link rel="stylesheet" href="github.css" type="text/css" />
</head>
<body>
<h1>Log File Acquire</h1>
<h3>Overview</h3>
<p>acquire event log<br />
br />
If you exceed the maximum number of generations to hold rotate when the log file, the log file of the oldest is deleted.</p>
<h3>Required Privileges</h3>
<p>log-read</p>
<h3>Restrictions</h3>
<ul>
<li>Maximum depth of the hierarchy of the collection 50</li>
<li>The maximum value of the child number of elements in each collection under 10,000
<ul>
<li>The collection immediately below the Box is regarded as the first level, and the collection is counted as the second level, the third level, Files to be created under the collection are not counted as hierarchies</li>
</ul></li>
<li>Log output of the internal event is not supported</li>
<li> Log output configuration is not supported. Log output configuration reference is not supported.</li>
<li>Set the log file name as "default.log "</li>
<li> Rotate will be according to following default settings
<ul>
<li>Set rotate size: 50MB</li>
</ul></li>
<li>Configure the log output level to "info" (output for all INFO, WARN, ERROR).</li>
<li>The file name when rotated is default.log. {timestamp}. {timestamp} is numbered by the time when it was rotated.</li>
</ul>
<table>
<colgroup>
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Action<br></th>
<th align="left">Archived log file<br></th>
<th align="left">Description<br></th>
<th align="left">Notes<br></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">First Rotation<br></td>
<td align="left">archive/<br>default.log.1402910774659<br></td>
<td align="left"><br>Newly rotated file<br></td>
<td align="left"><br>2014-06-16 18:26:14 +0900<br></td>
</tr>
<tr class="even">
<td align="left">2nd Rotation<br></td>
<td align="left">archive/<br>default.log.1402910774659<br>default.log.1403910784659<br></td>
<td align="left"><br>the preceding roteted file<br>Newly rotated file<br></td>
<td align="left"><br>2014-06-16 18:26:14 +0900<br>2014-06-28 08:13:04 +0900<br></td>
</tr>
<tr class="odd">
<td align="left">3rd Rotation<br></td>
<td align="left">archive/<br>default.log.1402910774659<br>default.log.1403910784659<br>default.log.1403910784659<br></td>
<td align="left"><br>the file before preceding file<br>the preceding roteted file<br>Newly rotated file<br></td>
<td align="left"><br>2014-06-16 18:26:14 +0900<br>2014-06-28 08:13:04 +0900<br>2014-07-09 21:59:44 +0900<br></td>
</tr>
</tbody>
</table>
<p><br></p>
<h3>Request</h3>
<h4 id="url">Request URL</h4>
<table>
<thead>
<tr class="header">
<th align="left">URL<br></th>
<th align="left">Overview<br></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">/{CellName}/__log/current/{LogName}<br></td>
<td align="left">Recent log file<br></td>
</tr>
<tr class="even">
<td align="left">/{CellName}/__log/current/{LogName}<br></td>
<td align="left">rotated log file<br></td>
</tr>
</tbody>
</table>
<p*{LogName} specifies the file name returned by the log file information acquisition API./p>
<h4>Request Method</h4>
<p>GET</p>
<h4>Request Query</h4>
<table>
<colgroup>
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Query Name<br></th>
<th align="left">Overview<br></th>
<th align="left">Effective Value<br></th>
<th align="left">Required<br></th>
<th align="left">Notes<br></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">p_cookie_peer<br></td>
<td align="left">Cookie Authentication Value<br></td>
<td align="left">The cookie authentication value returned from the server during authentication<br></td>
<td align="left">No<br></td>
<td align="left">Valid only if no Authorization header specified<br>Specify this when cookie authentication information is to be used<br></td>
</tr>
</tbody>
</table>
<h4>Request Header</h4>
<h5>Common Request Header</h5>
<table>
<colgroup>
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Header Name<br></th>
<th align="left">Overview<br></th>
<th align="left">Effective Value<br></th>
<th align="left">Required<br></th>
<th align="left">Notes<br></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">X-HTTP-Method-Override<br></td>
<td align="left">Method override function<br></td>
<td align="left">User-defined<br></td>
<td align="left">No<br></td>
<td align="left">Specifying this value in a request with the POST method indicates that the specified value is used as the method<br></td>
</tr>
<tr class="even">
<td align="left">X-Override<br></td>
<td align="left">Header override function<br></td>
<td align="left">${OverwrittenHeaderName}:${Value}<br></td>
<td align="left">No<br></td>
<td align="left">The normal HTTP header value is overwritten. Specify multiple X-Override headers for the overwriting of multiple headers<br></td>
</tr>
<tr class="odd">
<td align="left">X-Personium-RequestKey<br></td>
<td align="left">RequestKey field value output in the event log<br></td>
<td align="left">Single-byte alphanumeric characters, hyphens (&quot;-&quot;), and underscores (&quot;_&quot;)<br>Maximum of 128 characters<br></td>
<td align="left">No<br></td>
<td align="left">PCS-${UNIXtime} by default<br>Supported in V 1.1.7 and later<br></td>
</tr>
<tr class="even">
<td align="left">Authorization<br></td>
<td align="left">Specifies authentication information in the OAuth 2.0 format<br></td>
<td align="left">Bearer {UnitUserToken}<br></td>
<td align="left">No<br></td>
<td align="left">* Authentication tokens are the tokens acquired using the Authentication Token Acquisition API<br></td>
</tr>
</tbody>
</table>
<h4>Request Body</h4>
<p>None</p>
<h4>Request Sample</h4>
<p>None</p>
<p><br></p>
<h3>Response</h3>
<h4>Response Code</h4>
<p>200</p>
<h4>Response Header</h4>
<table>
<thead>
<tr class="header">
<th align="left">Header Name<br></th>
<th align="left">Overview<br></th>
<th align="left">Notes<br></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Content-Type<br></td>
<td align="left">MimeType depending on Resource<br></td>
<td align="left">&quot;text/csv&quot; or &quot;application/zip&quot;<br></td>
</tr>
</tbody>
</table>
<h4>Response Body</h4>
<p>If there is no log at current log acquisition time, return an empty response body.<br />
There is a possibility that the rotate size is about 5MB larger than it configured<br />
Output form is following</p>
<pre><code>{dateTime},[{level}],{RequestKey},{name},{schema},{subject},{action},{object},{result}</code></pre>
<table>
<colgroup>
<col width="5%" />
<col width="5%" />
<col width="5%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Item Name<br></th>
<th align="left">Overview<br></th>
<th align="left">Notes<br></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">dateTime<br></td>
<td align="left">Log write date and time (ISO8601 UTC format)<br></td>
<td align="left">YYYY-MM-DDTHH:MM:SS.sssZ<br></td>
</tr>
<tr class="even">
<td align="left">level<br></td>
<td align="left">log level INFO,WARN,ERROR<br></td>
<td align="left">String<br></td>
</tr>
<tr class="odd">
<td align="left">RequestKey<br></td>
<td align="left"> Value specified on X-Dc-RequestKey header<br>when the X-Dc-RequestKey header is not specified, PCS-$ {UNIX time}<br></td>
<td align="left">String<br></td>
</tr>
<tr class="even">
<td align="left">name<br></td>
<td align="left">External events: client<br>internal event: server<br></td>
<td align="left">String<br></td>
</tr>
<tr class="odd">
<td align="left">schema<br></td>
<td align="left">Schema of box of accepted URL<br></td>
<td align="left">URL format<br></td>
</tr>
<tr class="even">
<td align="left">subject<br></td>
<td align="left">Principal events<br></td>
<td align="left">URL format<br></td>
</tr>
<tr class="odd">
<td align="left">action<br></td>
<td align="left">External events: Action defined in the event reception<br>Internal events: HTTP method name<br></td>
<td align="left">String<br></td>
</tr>
<tr class="even">
<td align="left">object<br></td>
<td align="left">External events: Object defined in the event reception<br>Internal events:Requested resource path<br></td>
<td align="left">String<br></td>
</tr>
<tr class="odd">
<td align="left">result<br></td>
<td align="left">External events: Result defined in the event reception<br>Internal events:Requested resource path<br></td>
<td align="left">String<br></td>
</tr>
</tbody>
</table>
<h4>Error Messages</h4>
<p>Refer to <a href="004_Error_Messages.html">Error Message List</a></p>
<table>
<colgroup>
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Code<br></th>
<th align="left">Message<br></th>
<th align="left">Overview<br></th>
<th align="left">Notes<br></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">400<br></td>
<td align="left">Bad Request<br></td>
<td align="left">Invalid request body format<br>Invalid request header format<br>If Index of another schema type has already been created<br></td>
<td align="left"><br></td>
</tr>
<tr class="even">
<td align="left">401<br></td>
<td align="left">Unauthorized<br></td>
<td align="left">Invalid authentication tokenbr</td>
<td align="left"><br></td>
</tr>
<tr class="odd">
<td align="left">403<br></td>
<td align="left">Forbidden<br></td>
<td align="left">Insufficient access privileges<br></td>
<td align="left"><br></td>
</tr>
<tr class="even">
<td align="left">404<br></td>
<td align="left">Not Found<br></td>
<td align="left">Non-existent resource specified<br></td>
<td align="left"><br></td>
</tr>
<tr class="odd">
<td align="left">405<br></td>
<td align="left">Method Not Allowed<br></td>
<td align="left">Prohibited request method specified<br></td>
<td align="left"><br></td>
</tr>
</tbody>
</table>
<h4>Response Sample</h4>
<p>External Events</p>
<pre><code>2013-02-04T00:50:12.761Z,[INFO ],Req_animal-access_1001,client,https://{UnitFQDN}/{CellName}/,https://{UnitFQDN}/servicemanager/#admin,authSchema,/{CellName}/{BoxName}/service_name/token_keeper,[XXXX2033] Success schema authorization. cellUrl=https://{UnitFQDN}/keeper-d4a57bb26eae481486b07d06487051d1/</code></pre>
<p>Internal Event</p>
<pre><code>2013-04-18T14:52:39.778Z,[ERROR],PCS-1364350331902,server,https://{UnitFQDN}/appCell/,https://{UnitFQDN}/appCell/#staff,POST,/homeClinic/__auth,200</code></pre>
<p><br></p>
<h3 id="curl">CURL Command</h3>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="ex">curl</span> <span class="st">&quot;https://{UnitFQDN}/{CellName}/__log/current/default.log&quot;</span> -X GET -i -H <span class="st">&#39;Authorization: Bearer {UnitUserToken}&#39;</span> -H <span class="st">&#39;Accept: application/json&#39;</span>          </code></pre></div>
<p><br><br />
<br><br />
<br></p>
<h6 id="copyright-2017-fujitsu-limited">Copyright 2017 FUJITSU LIMITED</h6>
</body>
</html>
